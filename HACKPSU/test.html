<html>
  <head>
    <meta charset="utf-8">
    <title>Example article-parser</title>
    <link rel="stylesheet" href="/chota.min.css">
    <style>
      html, body {
        overflow-x: hidden;
        padding: 10px;
      }
      body {
        --bg-color: #000;
        --bg-secondary-color: #131316;
        --font-color: #f5f5f5;
        --color-grey: #ccc;
        --color-darkGrey: #777;
      }
    </style>
  </head>
  <body>
    <div class="row">
      <div class="col-12">
        <header>
          <h1>article-parser on browser</h1>
        </header>
        <form id="form_parser">
          <fieldset>
            <legend>enter link to blog post or news article</legend>
            <p>
              <input id="input_url" type="url" value="https://www.cnbc.com/2022/09/21/what-another-major-rate-hike-by-the-federal-reserve-means-to-you.html">
            </p>
            <p>
              <button class="button primary pull-right" id="btn_submit">Load and parse</button>
            </p>
          </fieldset>
        </form>
        <fieldset>
          <legend>Result</legend>
          <p>
            <textarea id="area_result" rows="12" cols="48"></textarea>
          </p>
        </fieldset>
      </div>
    </div>
  </body>
  <script type="module">
    import { extract } from "https://esm.sh/@extractus/article-extractor@latest"

    const loadFeed = async (url) => {
      const data = await extract(url, {
        descriptionLengthThreshold: 120,
        contentLengthThreshold: 300
      }, {
        proxy: null
      })
      return Object.assign(Object.create(null), data) // use pure object to hold data
    }

    const init = async () => {
        e.preventDefault()
        const feedurl = await chrome.tabs.query({active: true, lastFocusedWindow: true});
        console.log(feedurl)
        try {
          const oembed = await loadFeed(feedurl)
          console.log(JSON.stringify(oembed, undefined, '  '))
        } catch (err) {
          console.log(err.message)
        }
    }

    window.onload = init
  </script>
</html>